<!-- Panel de Administración Principal -->
<div class="admin-container">
  
  <!-- Header del Panel Admin -->
  <div class="admin-header">
    <mat-icon class="admin-icon">admin_panel_settings</mat-icon>
    <h2>Panel de Administración</h2>
    <p class="admin-subtitle">Gestiona usuarios, temas y documentos del sistema IntegraTesis</p>
  </div>

  <!-- Sección de Gestión de Usuarios -->
  <mat-card class="user-management-card">
    <mat-card-header class="section-header">
      <mat-card-title>
        <mat-icon>person_add</mat-icon>
        Gestión de Usuarios
      </mat-card-title>
      <button mat-icon-button (click)="toggleMinimize()" class="minimize-button"
              [title]="isMinimized ? 'Expandir formulario' : 'Minimizar formulario'">
        <mat-icon>{{ isMinimized ? 'expand_more' : 'expand_less' }}</mat-icon>
      </button>
    </mat-card-header>

    <mat-card-content *ngIf="!isMinimized" class="user-form-content">
      <div class="form-container">
        
        <!-- Columna 1: Credenciales -->
        <div class="form-column">
          <div class="form-section">
            <h4 class="section-title">
              <mat-icon>badge</mat-icon>
              Credenciales del Usuario
            </h4>
            <div class="form-fields">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Nombre completo</mat-label>
                <input matInput name="name" [(ngModel)]="newUser.name" required 
                       placeholder="Ej: Juan Pérez">
                <mat-icon matSuffix>person</mat-icon>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Email institucional</mat-label>
                <input matInput type="email" name="email" [(ngModel)]="newUser.email" required
                       placeholder="usuario@uach.cl">
                <mat-icon matSuffix>email</mat-icon>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Contraseña</mat-label>
                <input matInput type="password" name="password" [(ngModel)]="newUser.password" required
                       placeholder="Mínimo 8 caracteres">
                <mat-icon matSuffix>lock</mat-icon>
              </mat-form-field>
            </div>
          </div>
        </div>

        <!-- Columna 2: Rol y Permisos -->
        <div class="form-column">
          <div class="form-section">
            <h4 class="section-title">
              <mat-icon>assignment_ind</mat-icon>
              Rol y Permisos
            </h4>
            <div class="role-selection">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Seleccionar rol</mat-label>
                <mat-select name="role" [(ngModel)]="newUser.role" required>
                  <mat-option value="students">
                    <mat-icon>school</mat-icon>
                    Estudiante
                  </mat-option>
                  <mat-option value="professor">
                    <mat-icon>person</mat-icon>
                    Profesor
                  </mat-option>
                  <mat-option value="admin">
                    <mat-icon>admin_panel_settings</mat-icon>
                    Administrador
                  </mat-option>
                </mat-select>
              </mat-form-field>
              
              <!-- Información del rol seleccionado -->
              <div class="role-info" *ngIf="newUser.role">
                <div class="role-card student-role" *ngIf="newUser.role === 'students'">
                  <mat-icon>school</mat-icon>
                  <div class="role-details">
                    <strong>Estudiante</strong>
                    <p>Puede inscribirse en temas, ver documentos y proponer temas de tesis</p>
                  </div>
                </div>
                
                <div class="role-card professor-role" *ngIf="newUser.role === 'professor'">
                  <mat-icon>person</mat-icon>
                  <div class="role-details">
                    <strong>Profesor</strong>
                    <p>Puede crear y gestionar temas, subir documentos y evaluar propuestas</p>
                  </div>
                </div>
                
                <div class="role-card admin-role" *ngIf="newUser.role === 'admin'">
                  <mat-icon>admin_panel_settings</mat-icon>
                  <div class="role-details">
                    <strong>Administrador</strong>
                    <p>Acceso completo al sistema, gestión de usuarios y configuraciones</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Columna 3: Especialidades (solo para profesores) -->
        <div class="form-column" [ngClass]="{'hidden': newUser.role !== 'professor'}">
          <div class="form-section">
            <h4 class="section-title">
              <mat-icon>star</mat-icon>
              Especialidades y Fortalezas
            </h4>
            <mat-form-field appearance="outline" class="full-width" *ngIf="newUser.role === 'professor'">
              <mat-label>Áreas de especialidad</mat-label>
              <textarea matInput name="specialty" [(ngModel)]="newUser.specialty" 
                        rows="6" placeholder="Ej: Ingeniería de Software, Base de Datos, Inteligencia Artificial"></textarea>
              <mat-icon matSuffix>subject</mat-icon>
              <mat-hint>Separa las especialidades con comas</mat-hint>
            </mat-form-field>
          </div>
        </div>
      </div>

      <!-- Botón de crear usuario -->
      <div class="form-actions">
        <button mat-raised-button color="primary" (click)="createUser()" 
                class="create-user-button" [disabled]="!isFormValid()">
          <mat-icon>person_add</mat-icon>
          Crear Usuario
        </button>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Panel de Temas de Tesis -->
  <mat-card class="content-card topics-management-card">
    <mat-card-header class="section-header">
      <mat-card-title>
        <mat-icon>topic</mat-icon>
        Gestión de Temas de Tesis
      </mat-card-title>
      <mat-card-subtitle>
        Administra temas oficiales y propuestas de estudiantes
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content class="scrollable-content">
      <topic-list></topic-list>
    </mat-card-content>
  </mat-card>

  <!-- Panel de Documentos -->
  <mat-card class="content-card documents-management-card">
    <mat-card-header class="section-header">
      <mat-card-title>
        <mat-icon>description</mat-icon>
        Gestión de Documentos
      </mat-card-title>
      <mat-card-subtitle>
        Subir y administrar documentos del sistema
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content class="scrollable-content">
      <app-upload-document></app-upload-document>
      <app-document-list></app-document-list>
    </mat-card-content>
  </mat-card>
</div>